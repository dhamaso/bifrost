/*
 * jQuery Bifröst v1.0.0.alpha
 * http://matiasgagliano.github.com/bifrost/
 *
 * Copyright 2014, Matías Gagliano.
 * Dual licensed under the MIT or GPLv3 licenses.
 * http://opensource.org/licenses/MIT
 * http://opensource.org/licenses/GPL-3.0
 *
 */

(function(){"use strict";var t,e,r,i;t=jQuery;r=window.console||{log:function(){}};i=0;e=function(){function e(t,e,r){this.options=t;this.originalOptions=e;this.jqXHR=r}e.prototype.send=function(e,n){var a,o,s,p,f,c,u,m,l,d,h,y,v,g,T,b,j,x,O,P,A;y=this.options;l={"X-Requested-With":"IFrame"};if(y.accepts!=null){l["X-HTTP-Accept"]=y.accepts}if((O=y.type)==="DELETE"||O==="PUT"||O==="PATCH"){l["_method"]=y.type;y.type="POST"}i++;m="iframe-transport-"+i;u=this.iframe=t("<iframe>").css("display","none");u.attr({name:m,src:"javascript:false;"});u.appendTo(document.body);u.one("load",function(){var t,e;try{e=u.contents().find("body").text();n(200,"success",{iframe:e})}catch(i){t=i;r.log(t);n(403,"error",{iframe:""})}f.remove();return u.remove()});f=this.form=t("<form>").css("display","none");f.prop({target:m,action:y.url,method:y.type});f.appendTo(document.body);s=this.originalOptions.data;if(t.isArray(s)){h={};for(T=0,j=s.length;T<j;T++){v=s[T];P=[v.name,v.value],d=P[0],g=P[1];if(h[d]===void 0){h[d]=g}else if(t.isArray(h[d])){h[d].push(g)}else{h[d]=[h[d],g]}}s=h}s=t.extend({},l,s);for(d in s){g=s[d];f.append(t("<input>").attr({type:"hidden",name:d,value:g}))}p=t(y.fileInputs);o=t();if(y.type==="POST"&&p.length){f.prop({enctype:"multipart/form-data",encoding:"multipart/form-data"});o=p.clone().prop("disabled",true);p.after(function(t){return o[t]});f.append(p)}f.submit();A=[];for(c=b=0,x=o.length;b<x;c=++b){a=o[c];A.push(t(a).replaceWith(p[c]))}return A};e.prototype.abort=function(){if(this.form){this.form.remove()}if(this.iframe){return this.iframe.off("load")}};return e}();t.ajaxTransport("iframe",function(t,r,i){if(t.async){return new e(t,r,i)}});t.ajaxSetup({converters:{"iframe text":true,"iframe json":t.parseJSON,"iframe html":true,"iframe xml":t.parseXML,"iframe script":t.globalEval}})}).call(this);
